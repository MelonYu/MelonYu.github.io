<!DOCTYPE html>
<html>
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="utf-8">
  
  <title>Python 编程规范 | 余小梦 - 什么都想学的贪心鬼</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="“人生苦短，我学Python”">
<meta name="keywords" content="python,style,coding">
<meta property="og:type" content="article">
<meta property="og:title" content="Python 编程规范">
<meta property="og:url" content="https://mollyyue.github.io/2018/01/21/Python-编程规范-Google/index.html">
<meta property="og:site_name" content="余小梦 - 什么都想学的贪心鬼">
<meta property="og:description" content="“人生苦短，我学Python”">
<meta property="og:locale" content="zh-Hans">
<meta property="og:image" content="https://mollyyue.github.io/assets/blogImg/python-logo.png">
<meta property="og:updated_time" content="2019-11-29T14:20:08.049Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Python 编程规范">
<meta name="twitter:description" content="“人生苦短，我学Python”">
<meta name="twitter:image" content="https://mollyyue.github.io/assets/blogImg/python-logo.png">
  
    <link rel="icon" href="/assets/img/m.ico">
  
  <link rel="stylesheet" href="//cdn.bootcss.com/highlight.js/9.2.0/styles/github.min.css">
  <script src="//cdn.bootcss.com/highlight.js/9.2.0/highlight.min.js"></script>
  <script>
    document.addEventListener('DOMContentLoaded', (event) => {
      document.querySelectorAll('pre code').forEach((block) => {
        hljs.highlightBlock(block);
      });
    });
  </script>
  <link rel="stylesheet" href="/css/index.css">
</head>
</html>
<body style="


  background-color: #eff0f6

">
  <div id="container">
    <nav id="nav">
  <header class="header">
    <a href="/" class="title">余小梦</a>
  </header>
  <div class="ctnWrap">
    <div class="icons">
      
        
          
            <a href="https://github.com/xiaomengyyy" target="_blank" class="nav-icn iconfont icon-github"></a>
          
        
          
            <a href="https://juejin.im/user/5c442cd7f265da612b13de4a/posts" target="_blank" class="nav-icn iconfont icon-juejin"></a>
          
        
          
            <a href="http://mp.weixin.qq.com/s?__biz=MzIwNDA3MjMwMg==&amp;mid=401511176&amp;idx=1&amp;sn=87a706f9adf6d666516d41e7f275e34f&amp;chksm=04df870933a80e1f641ea24c1ba00652e22d3e59ad28e78dc49dd0241048498028a8a128976c#rd" target="_blank" class="nav-icn iconfont icon-wechat"></a>
          
        
          
            <a href="https://www.instagram.com/menglingyyy/" target="_blank" class="nav-icn iconfont icon-instagram"></a>
          
        
          
            <a href="https://500px.me/xiaomengyyy" target="_blank" class="nav-icn iconfont icon-500px"></a>
          
        
          
            <a href="/about" target="_blank" class="nav-icn iconfont icon-about"></a>
          
        
      
    </div>
    <div class="menu">
      
        
            <a href="/" class="nav-menu ">主页</a>
          
        
            <a href="/archives" class="nav-menu ">归档</a>
          
        
            <a href="/tags" class="nav-menu ">标签</a>
          
        
            <a href="/categories/test" class="nav-menu ">软件测试</a>
          
        
            <a href="/categories/thoughts" class="nav-menu ">思考</a>
          
        
      
    </div>
  </div>
</nav>
    <div id="main"><section class="article">
  <h2 class="title">Python 编程规范</h2>
  <p class="sub">Jan 21, 2018</p>
  <article class="content">
    <p><img src="/assets/img/python-home.png" alt="python-home"></p>
<p><strong>在一开始就按照编程规范来组织自己的代码，比自己瞎写来得有效率得多。</strong><br>本文是结合Google官方英文版<em>Google Python Style Guide</em> 及各类<em>网络资源</em>的个人学习笔记。</p>
<p><strong>以下代码中 Yes 表示推荐， No 表示不推荐</strong></p>
<h1 id="分号"><a href="#分号" class="headerlink" title="分号"></a>分号</h1><p><strong>Do not terminate your lines with semi-colons and do not use semi-colons to put two commands on the same line.</strong><br>不要在行尾加分号，也不要用分号将两条命令放在同一行。</p>
<h1 id="行长度"><a href="#行长度" class="headerlink" title="行长度"></a>行长度</h1><p><strong>Maximum line length is 80 characters.</strong></p>
<p>Exceptions:</p>
<ul>
<li>Long import statements.</li>
<li>URLs in comments.<br>Do not use backslash line continuation.</li>
</ul>
<p>Make use of Python’s implicit line joining inside parentheses, brackets and braces. If necessary, you can add an extra pair of parentheses around an expression.</p>
<p>每行不超过80个字符<br>以下情况除外：</p>
<ul>
<li>长的导入模块语句</li>
<li>注释里的URL</li>
</ul>
<p>不要使用反斜杠连接行。<br>Python会将 圆括号, 中括号和花括号中的行隐式的连接起来 , 你可以利用这个特点. 如果需要, 你可以在表达式外围增加一对额外的圆括号。</p>
<pre><code class="python">  Yes: foo_bar(self, width, height, color=&#39;black&#39;, design=None,x=&#39;foo&#39;,
               emphasis=None, highlight=0)

       if (width == 0 and height == 0 and
           color == &#39;red&#39; and emphasis == &#39;strong&#39;):</code></pre>
<p>  如果一个文本字符串在一行放不下, 可以使用圆括号来实现隐式行连接:</p>
<pre><code class="python">  x = (&#39;This will build a very long long &#39;
     &#39;long long long long long long string&#39;)</code></pre>
<p>  在注释中，如果必要，将长的URL放在一行上。</p>
<pre><code class="python">  Yes:  # See details at
  #http://www.example.com/us/developer/documentation/api/content/v2.0/csv_file_name_extension_full_specification.html</code></pre>
<h1 id="括号"><a href="#括号" class="headerlink" title="括号"></a>括号</h1><p><strong>Use parentheses sparingly.</strong><br>Do not use them in return statements or conditional statements unless using parentheses for implied line continuation. (See above.) It is however fine to use parentheses around tuples.</p>
<p>宁缺毋滥的使用括号。<br>除非是用于实现行连接, 否则不要在返回语句或条件语句中使用括号. 不过在元组两边使用括号是可以的.</p>
<pre><code class="python">Yes: if foo:
         bar()
     while x:
         x = bar()
     if x and y:
         bar()
     if not x:
         bar()
     return foo
     for (x, y) in dict.items(): ...</code></pre>
<pre><code class="python">No:  if (x):
         bar()
     if not(x):
         bar()
     return (foo)</code></pre>
<h1 id="缩进"><a href="#缩进" class="headerlink" title="缩进"></a>缩进</h1><p><strong>Indent your code blocks with 4 spaces.</strong><br>Never use tabs or mix tabs and spaces. In cases of implied line continuation, you should align wrapped elements either vertically, as per the examples in the line length section; or using a hanging indent of 4 spaces, in which case there should be no argument on the first line.</p>
<p>用4个空格来缩进代码<br>绝对不要用tab, 也不要tab和空格混用. 对于行连接的情况, 你应该要么垂直对齐换行的元素，要么使用4空格的悬挂式缩进(这时第一行不应该有参数):</p>
<pre><code class="python">Yes:   # Aligned with opening delimiter (与起始变量对齐)
       foo = long_function_name(var_one, var_two,
                                var_three, var_four)

       # Aligned with opening delimiter in a dictionary(字典中与起始值对齐)
       foo = {
           long_dictionary_key: value1 +
                                value2,
           ...
       }

       # 4-space hanging indent; nothing on first line(4 个空格缩进，第一行不需要)
       foo = long_function_name(
           var_one, var_two, var_three,
           var_four)

       # 4-space hanging indent in a dictionary(字典中 4 个空格缩进)
       foo = {
           long_dictionary_key:
               long_dictionary_value,
           ...
       }</code></pre>
<h1 id="空格"><a href="#空格" class="headerlink" title="空格"></a>空格</h1><p><strong>Follow standard typographic rules for the use of spaces around punctuation.</strong><br>按照标准的排版规范来使用标点两边的空格。</p>
<p>No whitespace inside parentheses, brackets or braces.<br>括号()内不要有空格.</p>
<pre><code class="python">Yes: spam(ham[1], {eggs: 2}, [])</code></pre>
<pre><code class="python">No:  spam( ham[ 1 ], { eggs: 2 }, [ ] )</code></pre>
<p>不要在逗号, 分号, 冒号前面加空格, 但应该在它们后面加(除了在行尾)。</p>
<pre><code class="python">Yes: if x == 4:
         print x, y
     x, y = y, x</code></pre>
<pre><code class="python">No:  if x == 4 :
         print x , y
     x , y = y , x</code></pre>
<p>参数列表, 索引或切片的左括号前不应加空格.</p>
<pre><code class="python">Yes: spam(1)</code></pre>
<pre><code class="python">no: spam (1)</code></pre>
<pre><code class="python">Yes: dict[&#39;key&#39;] = list[index]</code></pre>
<pre><code class="python">No:  dict [&#39;key&#39;] = list [index]</code></pre>
<p>在二元操作符两边都加上一个空格, 比如赋值(=), 比较(==, &lt;, &gt;, !=, &lt;&gt;, &lt;=, &gt;=, in, not in, is, is not), 布尔(and, or, not). 至于算术操作符两边的空格该如何使用, 需要你自己好好判断. 不过两侧务必要保持一致.</p>
<pre><code class="python">Yes: x == 1</code></pre>
<pre><code class="python">No:  x&lt;1</code></pre>
<p>当’=’用于指示关键字参数或默认参数值时, 不要在其两侧使用空格.</p>
<pre><code class="python">Yes: def complex(real, imag=0.0): return magic(r=real, i=imag)</code></pre>
<pre><code class="python">No:  def complex(real, imag = 0.0): return magic(r = real, i = imag)</code></pre>
<p>不要用空格来垂直对齐多行间的标记, 因为这会成为维护的负担(适用于:, #, =等):</p>
<pre><code class="python">Yes:
     foo = 1000  # 注释
     long_name = 2  # 注释不需要对齐

     dictionary = {
         &quot;foo&quot;: 1,
         &quot;long_name&quot;: 2,
         }</code></pre>
<pre><code class="python">No:
     foo       = 1000  # 注释
     long_name = 2     # 注释不需要对齐

     dictionary = {
         &quot;foo&quot;      : 1,
         &quot;long_name&quot;: 2,
         }</code></pre>
<h1 id="字符串"><a href="#字符串" class="headerlink" title="字符串"></a>字符串</h1><p><strong>Use the format method or the % operator for formatting strings, even when the parameters are all strings. Use your best judgement to decide between + and % (or format) though.</strong></p>
<p>使用格式化方法或%操作符来格式化字符串，即使所有的参数都是字符串。用你最好的判断来决定+和%（或format）。</p>
<pre><code class="python">Yes: x = a + b
     x = &#39;%s, %s!&#39; % (imperative, expletive)
     x = &#39;{}, {}!&#39;.format(imperative, expletive)
     x = &#39;name: %s; score: %d&#39; % (name, n)
     x = &#39;name: {}; score: {}&#39;.format(name, n)</code></pre>
<pre><code class="python">No: x = &#39;%s%s&#39; % (a, b)  # use + in this case
    x = &#39;{}{}&#39;.format(a, b)  # use + in this case
    x = imperative + &#39;, &#39; + expletive + &#39;!&#39;
    x = &#39;name: &#39; + name + &#39;; score: &#39; + str(n)</code></pre>
<p>避免在循环中用+和+=操作符来累加字符串. 由于字符串是不可变的, 这样做会创建不必要的临时对象, 并且导致二次方而不是线性的运行时间. 作为替代方案, 你可以将每个子串加入列表, 然后在循环结束后用 .join 连接列表. (也可以将每个子串写入一个 cStringIO.StringIO 缓存中.)</p>
<pre><code class="python">Yes: items = [&#39;&lt;table&gt;&#39;]
     for last_name, first_name in employee_list:
         items.append(&#39;&lt;tr&gt;&lt;td&gt;%s, %s&lt;/td&gt;&lt;/tr&gt;&#39; % (last_name, first_name))
     items.append(&#39;&lt;/table&gt;&#39;)
     employee_table = &#39;&#39;.join(items)</code></pre>
<pre><code class="python">No: employee_table = &#39;&lt;table&gt;&#39;
    for last_name, first_name in employee_list:
        employee_table += &#39;&lt;tr&gt;&lt;td&gt;%s, %s&lt;/td&gt;&lt;/tr&gt;&#39; % (last_name, first_name)
    employee_table += &#39;&lt;/table&gt;&#39;</code></pre>
<h1 id="导入格式"><a href="#导入格式" class="headerlink" title="导入格式"></a>导入格式</h1><p><strong>Imports should be on separate lines.</strong><br>每个导入应该独占一行。</p>
<pre><code class="python">Yes: import os
     import sys</code></pre>
<pre><code class="python">No:  import os, sys</code></pre>
<p>导入总应该放在文件顶部, 位于模块注释和文档字符串之后, 模块全局变量和常量之前. 导入应该按照从最通用到最不通用的顺序分组:</p>
<ul>
<li>标准库导入</li>
<li>第三方库导入</li>
<li>应用程序指定导入<br>每种分组中, 应该根据每个模块的完整包路径按字典序排序, 忽略大小写.<pre><code class="python">import foo
from foo import bar
from foo.bar import baz
from foo.bar import Quux
from Foob import ar</code></pre>
<h1 id="命名"><a href="#命名" class="headerlink" title="命名"></a>命名</h1>module_name, package_name, ClassName, method_name, ExceptionName, function_name, GLOBAL_CONSTANT_NAME, global_var_name, instance_var_name, function_parameter_name, local_var_name.</li>
</ul>
<p>应该避免的名称：</p>
<ol>
<li>单字符名称, 除了计数器和迭代器.</li>
<li>包/模块名中的连字符(-)</li>
<li>双下划线开头并结尾的名称(Python保留, 例如<strong>init</strong>)</li>
</ol>
<p>命名约定：</p>
<ol>
<li>所谓”内部(Internal)”表示仅模块内可用, 或者, 在类内是保护或私有的.</li>
<li>用单下划线(_)开头表示模块变量或函数是protected的(使用import * from时不会包含).</li>
<li>用双下划线(__)开头的实例变量或方法表示类内私有.</li>
<li>将相关的类和顶级函数放在同一个模块里. 不像Java, 没必要限制一个类一个模块.</li>
<li>对类名使用大写字母开头的单词(如CapWords, 即Pascal风格), 但是模块名应该用小写加下划线的方式(如lower_with_under.py). 尽管已经有很多现存的模块使用类似于CapWords.py这样的命名, 但现在已经不鼓励这样做, 因为如果模块名碰巧和类名一致, 这会让人困扰.</li>
</ol>
<p>Python之父Guido推荐的规范:</p>
<table>
<thead>
<tr>
<th align="left">Type</th>
<th align="left">Public</th>
<th align="left">Internal</th>
</tr>
</thead>
<tbody><tr>
<td align="left">Packages</td>
<td align="left">lower_with_under</td>
<td align="left"></td>
</tr>
<tr>
<td align="left">Modules</td>
<td align="left">lower_with_under</td>
<td align="left">_lower_with_under</td>
</tr>
<tr>
<td align="left">Classes</td>
<td align="left">CapWords</td>
<td align="left">_CapWords</td>
</tr>
<tr>
<td align="left">Exceptions</td>
<td align="left">CapWords</td>
<td align="left"></td>
</tr>
<tr>
<td align="left">Functions</td>
<td align="left">lower_with_under()</td>
<td align="left">_lower_with_under()</td>
</tr>
<tr>
<td align="left">Global/Class Constants</td>
<td align="left">CAPS_WITH_UNDER</td>
<td align="left">_CAPS_WITH_UNDER</td>
</tr>
<tr>
<td align="left">Global/Class Variables</td>
<td align="left">lower_with_under</td>
<td align="left">_lower_with_under</td>
</tr>
<tr>
<td align="left">Instance Variables</td>
<td align="left">lower_with_under</td>
<td align="left">_lower_with_under (protected) or __lower_with_under (private)</td>
</tr>
<tr>
<td align="left">Method Names</td>
<td align="left">lower_with_under()</td>
<td align="left">_lower_with_under() (protected) or __lower_with_under() (private)</td>
</tr>
<tr>
<td align="left">Function/Method Parameters</td>
<td align="left">lower_with_under</td>
<td align="left"></td>
</tr>
<tr>
<td align="left">Local Variables</td>
<td align="left">lower_with_under</td>
<td align="left"></td>
</tr>
</tbody></table>
<h1 id="Main"><a href="#Main" class="headerlink" title="Main"></a>Main</h1><p>Even a file meant to be used as a script should be importable and a mere import should not have the side effect of executing the script’s main functionality. The main functionality should be in a main() function.</p>
<p>即使是一个打算被用作脚本的文件, 也应该是可导入的. 并且简单的导入不应该导致这个脚本的主功能(main functionality)被执行, 这是一种副作用. 主功能应该放在一个main()函数中.</p>
<p>在Python中, pydoc以及单元测试要求模块必须是可导入的. 你的代码应该在执行主程序前总是检查 if <strong>name</strong> == ‘<strong>main</strong>‘ , 这样当模块被导入时主程序就不会被执行.</p>
<pre><code class="python">def main():
      ...

if __name__ == &#39;__main__&#39;:
    main()</code></pre>
<p>所有的顶级代码在模块导入时都会被执行. 要小心不要去调用函数, 创建对象, 或者执行那些不应该在使用pydoc时执行的操作.</p>
  </article>
  <footer class="f-cf">
    
      <a href="/2018/05/06/git-cheat-sheet/" class="link f-fl">⟵git cheat sheet</a>
    
    
      <a href="/2017/06/06/Hexo+Github Pages 搭建个人博客 - 准备篇/" class="link f-fr">Hexo+Github Pages 搭建个人博客 - 准备篇⟶</a>
    
  </footer>
</section></div>
    <footer id="footer" class="f-cf">
  xiaomeng.yu@foxmail.com
  
    
      
        · <a href="https://github.com/xiaomengyyy" target="_blank" class="nav-icn">GitHub</a>
      
    
      
        · <a href="https://juejin.im/user/5c442cd7f265da612b13de4a/posts" target="_blank" class="nav-icn">Juejin</a>
      
    
      
        · <a href="http://mp.weixin.qq.com/s?__biz=MzIwNDA3MjMwMg==&amp;mid=401511176&amp;idx=1&amp;sn=87a706f9adf6d666516d41e7f275e34f&amp;chksm=04df870933a80e1f641ea24c1ba00652e22d3e59ad28e78dc49dd0241048498028a8a128976c#rd" target="_blank" class="nav-icn">Wechat</a>
      
    
      
        · <a href="https://www.instagram.com/menglingyyy/" target="_blank" class="nav-icn">Instagram</a>
      
    
      
        · <a href="https://500px.me/xiaomengyyy" target="_blank" class="nav-icn">500px</a>
      
    
      
        · <a href="/about" target="_blank" class="nav-icn">About</a>
      
    
  
  <span class="copyright">2019 All rights reserved @MollyYue</span>
</footer>
  </div>
</body>
</html>